<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Interactive Quiz App</title>
  <!-- <link rel="stylesheet" href="quiz app.css" /> -->
  <style>
  *{
    margin:0;
    padding: 0;
    box-sizing: border-box;
    font-family: "poppins",sans-serif;  
}
body{
    min-height:100vh;
    display: flex;    align-items:center;
    justify-content: center;
    background-color: rgb(16, 16, 16);
}
.container{
    position: relative;
    width: 100%;
    max-width: 500px;
    background-color:rgb(16, 16, 16);
    padding: 30px;
    overflow: hidden;
    border-radius: 10px;
    box-shadow: 0 0 25px rgb(254, 6, 159);
}
.heading{
    text-align:center;
    font-size: 80px;
    color:#f4f5f8;
    margin-bottom: 60px;
}
label{
    display: block;
    font-size: 25px;
    margin-bottom: 20px;
    color: #f4f4f7;
    text-transform: capitalize;
}
select{
    width:100%;
    height: 70px;
    padding: 10px;
    text-transform: capitalize;
    border-radius: 10px;
    margin-bottom: 30px;
    background-color: rgb(139, 69, 125);
    color: rgb(14, 14, 14);
    font-size: 20px;
}
.btn{
    width:100%;
    height:70px;
    background-color:  rgb(224, 6, 140);
    border:none;
    border-radius: 100px;
    color:azure;
    margin-top: 50px;
    font-size: 30px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s linear;
}
.btn:hover{
    background-color: #c05ea2;
}
.btn:disabled{
    cursor:pointer;
    background-color: rgb(254, 6, 159);
}
.hide{
    display: none;
}
.timer{
    width:100%;
    height:100px;
    display:flex;
    align-items:center;
    justify-content: center;
    margin-bottom: 30px;
}
.timer .progress{
    position: relative;
    width: 100%;
    height: 40px;
    background-color: transparent;
    border-radius: 40px;
    overflow: hidden;
    margin-bottom: 50px;
    border:3px solid  rgb(254, 6, 159);
} 
.timer .progress .progress-bar{
    width:50%;
    height: 100%;
    border-radius:30px;
    overflow: hidden;
    background: linear-gradient(to right,#ea517c,#b478f1);
    transition: 1s  linear;
}
.timer .progress .progress-text{
    position: absolute;
    top:50%;
    left: 50%;
    transform: translate(-50%,-50%);
    color:#f5f1f1;
    font-size: 25px;
    font-weight: 500;
}
.question-wrapper .number{
    color:#fff;
    font-size: 30px;
    font-weight: 500;
    margin-bottom: 30px;
}
.question-wrapper .number .total{
    color:#fff;
    font-size: 25px;
}
.question-wrapper .question{
    color:#fff;
    font-size: 35px;
    font-weight: 500;
    margin-bottom: 20px;
}
.answer-wrapper .answer{
    width: 100%;
    height: 80px;
    padding: 20px;
    border-radius:10px;
    color:#fff;
    border: 3px solid rgb(240, 6, 149);
    display: flex;
    align-items:center;
    justify-content: space-between;
    margin-bottom: 20px;
    cursor: pointer;
    transition:0.3s linear;
    font-size: 25px;
}
.answer .checkbox{
    width: 40px;
    height: 40px;
    font-size:20px;
    border-radius:80px;
    border :3px solid #eb0aa8;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
}
.answer .checkbox .icon{
    opacity:0;
}
.answer:hover .checkbox,
.answer.selected .checkbox{
    background-color: #31192dfd;
    border-color: #bf1584;
}
.answer.selected .checkbox .icon{
    opacity: 1;
}
.answer.correct{
    border-color:rgb(14, 228, 14);
}
.answer.wrong{
    border-color:rgb(244, 5, 5);
}
.question-wrapper,
.answer-wrapper{
    margin-bottom: 10px;
}
.btn.next{
    /* show when answer submit */
    display: none;
   
}
.end-screen .score{
    color:#fff;
     font-size: 50px;
    font-weight: 500;
    margin-bottom: 80px;
    text-align: center;
}
.end-screen .score-text{
    color: #f7f8fc;
    font-size: 50px;
    margin-bottom: 50px;
}

@media(max-width:468){
    .container{
        min-height: 100vh;
        max-width: 100%;
        border-radius: 0;
    }
}
</style>
</head>
<body>
  <div class="container">
    <div class="start-screen">
      <h1 class="heading">QUIZ APP</h1>
      <div class="settings">
        <label for="num-questions">Number of Questions</label>
        <select id="num-questions" name="num-questions">
          <option value="5">5</option>
          <option value="10">10</option>
          <option value="20">20</option>
          <option value="25">25</option>
          <option value="50">50</option>
        </select>

        <label for="category">Select Category</label>
        <select id="category" name="category">
          <option value="">Any Category</option>
          <option value="9">General Knowledge</option>
          <option value="18">Science: Computers</option>
          <option value="21">Sports</option>
          <option value="23">History</option>
        </select>

        <label for="difficulty">Select Difficulty</label>
        <select id="difficulty" name="difficulty">
          <option value="">Any Difficulty</option>
          <option value="easy">Easy</option>
          <option value="medium">Medium</option>
          <option value="hard">Hard</option>
        </select>

        <label for="time">Select Time</label>
        <select id="time" name="time">
          <option value="10">10</option>
          <option value="20">20</option>
          <option value="30">30</option>
          <option value="40">40</option>
          <option value="50">50</option>
          <option value="60">60</option>
        </select>
      </div>
      <button class="btn start">Start Quiz</button>
    </div>

    <div class="quiz hide">
      <div class="timer">
        <div class="progress">
          <div class="progress-bar"></div>
          <span class="progress-text">50</span>
        </div>
      </div>
      <div class="question-wrapper">
        <div class="number">
          Question <span class="current">1</span>
          <span class="total">/10</span>
        </div>
        <div class="question">This is a Question</div>
      </div>
      <div class="answer-wrapper">
        <div class="answer selected">
          <span class="text">Answer</span>
          <span class="checkbox">
            <span class="icon">✔</span>
          </span>
        </div>
        <div class="answer correct">
          <span class="text">Answer</span>
          <span class="checkbox">
            <span class="icon">✔</span>
          </span>
        </div>
        <div class="answer wrong">
          <span class="text">Answer</span>
          <span class="checkbox">
            <span class="icon">✔</span>
          </span>
        </div>
      </div>
      <button class="btn submit" disabled>Submit</button>
      <button class="btn next">Next</button>
    </div>

    <div class="end-screen hide">
      <h1 class="heading">QUIZ APP</h1>
      <div class="score">
        <div class="score-text">Your Score:</div>
        <div>
          <span class="final-score">0</span>
          <span class="total-score">/10</span>
        </div>
      </div>
      <button class="btn restart">Restart Quiz</button>
    </div>
  </div>
  <!-- <script src="quiz app.js"></script> -->
   <script>
    const progressBar = document.querySelector(".progress-bar"),
    progressText = document.querySelector(".progress-text");

const progress = (value) => {
    const percentage = (value / time) * 100;
    progressBar.style.width = `${percentage}%`;
    progressText.innerHTML = `${value}`;
};

let questions = [], 
    time = 60,
    score = 0,
    currentQuestion,
    timer;

const startBtn = document.querySelector(".start"),
    numQuestions = document.querySelector("#num-questions"),
    category = document.querySelector("#category"),
    difficulty = document.querySelector("#difficulty"),
    timePerQuestion = document.querySelector("#time"),
    quiz = document.querySelector(".quiz"),
    startscreen = document.querySelector(".start-screen");

const startQuiz = () => {
    const num = numQuestions.value;
    const cat = category.value;
    const diff = difficulty.value;

    const url = `https://opentdb.com/api.php?amount=${num}&category=${cat}&difficulty=${diff}&type=multiple`;

    fetch(url)
        .then((res) => res.json())
        .then((data) => {
            questions = data.results;
            startscreen.classList.add("hide");
            quiz.classList.remove("hide");
            currentQuestion = 1;
            showQuestion(questions[0]);
        });
};

startBtn.addEventListener("click", startQuiz);

const submitBtn = document.querySelector(".submit"),
    nextBtn = document.querySelector(".next");

const showQuestion = (question) => {
    const questionText = document.querySelector(".question"),
        answersWrapper = document.querySelector(".answer-wrapper"),
        questionNumber = document.querySelector(".number");

    questionText.innerHTML = question.question;

    const answers = [...question.incorrect_answers, question.correct_answer.toString()];
    answers.sort(() => Math.random() - 0.5);
    answersWrapper.innerHTML = "";

    answers.forEach((answer) => {
        answersWrapper.innerHTML += `
            <div class="answer">
                <span class="text">${answer}</span>
                <span class="checkbox">
                    <span class="icon">✔</span>
                </span>
            </div>
        `;
    });

    questionNumber.innerHTML = `
        Question <span class="current">${questions.indexOf(question) + 1}</span>
        <span class="total">/${questions.length}</span>
    `;

    const answerDivs = document.querySelectorAll(".answer");
    answerDivs.forEach((answer) => {
        answer.addEventListener("click", () => {
            if (!answer.classList.contains("checked")) {
                answerDivs.forEach((a) => a.classList.remove("selected"));
                answer.classList.add("selected");
                submitBtn.disabled = false;
            }
        });
    });

    time = parseInt(timePerQuestion.value);
    startTimer(time);
};

const startTimer = (t) => {
    let currentTime = t;
    timer = setInterval(() => {
        if (currentTime > 0) {
            progress(currentTime);
            currentTime--;
        } else {
            clearInterval(timer);
            checkAnswer();
        }
    }, 1000);
};

submitBtn.addEventListener("click", () => {
    checkAnswer();
});

const checkAnswer = () => {
    clearInterval(timer);

    const selectedAnswer = document.querySelector(".answer.selected");
    const correct = questions[currentQuestion - 1].correct_answer;

    if (selectedAnswer) {
        const answerText = selectedAnswer.querySelector(".text").innerHTML;
        if (answerText === correct) {
            score++;
            selectedAnswer.classList.add("correct");
        } else {

            selectedAnswer.classList.add("wrong");
            constAnswer = document
            .querySelectorAll(".answer")
            .forEach((answer) => {
                if (
                answer.querySelector(".text").innerHTML === 
            questions[currentQuestion - 1 ].correct_answer
        ) {
                answer.classList.add("correct");
                }
            });
        }
    } else {
        document.querySelectorAll(".answer").forEach((answer) => {
            if (answer.querySelector(".text").innerHTML === correct) {
                answer.classList.add("correct");
            }
        });
    }

    document.querySelectorAll(".answer").forEach((answer) => {
        answer.classList.add("checked");
    });

    submitBtn.style.display = "none";
    nextBtn.style.display = "block";
};

nextBtn.addEventListener("click", () => {
    nextQuestion();
});

const nextQuestion = () => {
    if (currentQuestion < questions.length) {
        currentQuestion++;
        showQuestion(questions[currentQuestion - 1]);
        submitBtn.style.display = "block";
        nextBtn.style.display = "none";
        submitBtn.disabled = true;
    } else {
        showScore();
    }
};

const endScreen = document.querySelector(".end-screen"),
    finalScore = document.querySelector(".final-score"),
    totalScore = document.querySelector(".total-score");

const showScore = () => {
    endScreen.classList.remove("hide");
    quiz.classList.add("hide");
    finalScore.innerHTML = score;
    totalScore.innerHTML = `/${questions.length}`;
};

const restartBtn = document.querySelector(".restart");
restartBtn.addEventListener("click", () => {
    window.location.reload();
});
   </script>
</body>
</html>
